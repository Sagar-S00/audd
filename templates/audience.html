<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="/assets/bootstrap.min.css">
  <link rel="stylesheet" href="/assets/index.css">
  <link rel="stylesheet" href="/st.css">



  <!-- include Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">

  <!-- include jQuery -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <!-- include Bootstrap JS -->
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script>

  <title>Dashboard</title>
<style>
      #message {
        padding: 20px;
        background-color: #fff;
        border: 1px solid #ccc;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        display: none;
        text-align: center;
        max-width: 400px;
    }
    #copy-link {
        color: #007bff;
        cursor: pointer;
        text-decoration: underline;
    }
    #copy-link:hover {
        color: #0056b3;
    }

    #timer {
            position: absolute;
            font-family: Arial, sans-serif;
            top: 20px;
            left: 20px;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 5px;
            cursor: move;
            transition: opacity 0.5s;
        }
    #timer.transparent {
            opacity: 0.5;
        }
   
</style>
</head>


<body>
  <br>
  <div id="timer"></div>
  <div id="navbar">

    <img id="navbar-toggle-button" src="/setting.svg" alt="Toggle Navbar" width="25" height="25">
    <div id="navbar-content">

      <ul>
        <li><button id="join" type="submit" class="btn btn-primary btn-sm">Join</button></li>
        <li><button id="leave" type="button" class="btn btn-primary btn-sm" disabled>Leave</button></li>
        <li><button id="ref_vc" type="button" class="btn btn-primary btn-sm">Ref Voice</button></li>
        <li><button id="record-button" type="button" class="btn btn-primary btn-sm">Recording</button></li>
        <li><button id="stop-button" type="button" class="btn btn-primary btn-sm">Stop</button></li>
      </ul>
    </div>
  </div>
  <div id="profile-container">
    <div id="host-profile"></div>
    <div id="onlineusers">
      <div class="green-dot"></div>
      <div class="online-users-text">12</div>
    </div>
    <div id="profile-up-container">

    </div>
</div>
</div>
    <div>
      <div class="container mt-5 left-aligned">
        <label for="your name"><i class="zmdi zmdi-account material-icons-name"></i></label>
        <input type="text" id="input" placeholder="Link" required title="url" />
  
        <button type="button" class="btn btn-primary" id="submit-channel-name">StartVc</button>
      </div>

  <div id="members">
    <div id="uu">

    </div>
  </div>
  <div class="transparent-line" id="clickableLine"></div>


  <div class="row video-group">
    <div class="col">
      <p id="local-player-name" class="player-name"></p>

      <div id="local-player" class="player"></div>
      <audio id="audio" class="player"></audio>
    </div>
    <div class="w-100"></div>
    <div class="col">
      <div id="remote-playerlist"></div>
    </div>
  </div>
</div>

  
  <script>
    const userKey = localStorage.getItem('user');
    console.log(userKey);
    if (userKey !="bakugo"){
      function updateTimer() {
      const expirationTime = parseInt(localStorage.getItem('userKeyExpiration'), 10);
      if (isNaN(expirationTime)) {
          document.getElementById('timer').innerText = 'No expiration time found';
          return;
      }

      const now = Date.now();
      const timeLeft = expirationTime - now;

      if (timeLeft <= 0) {
          document.getElementById('timer').innerText = 'Key expired';
          window.location.href = `/error.html?user=${userKey}`;
          return;
      }

      const hours = Math.floor(timeLeft / (1000 * 60 * 60));
      const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);

      document.getElementById('timer').innerText = `${hours}h ${minutes}m ${seconds}s left`;
        }





        const timerDiv = document.getElementById('timer');
  let isDragging = false;
  let lastTouchTime = Date.now();

  timerDiv.addEventListener('mousedown', function(e) {
      isDragging = true;
      let startX = e.clientX - timerDiv.offsetLeft;
      let startY = e.clientY - timerDiv.offsetTop;

      function move(e) {
          let newX = e.clientX - startX;
          let newY = e.clientY - startY;

          newX = Math.max(0, Math.min(newX, window.innerWidth - timerDiv.clientWidth));
          newY = Math.max(0, Math.min(newY, window.innerHeight - timerDiv.clientHeight));

          timerDiv.style.left = newX + 'px';
          timerDiv.style.top = newY + 'px';
      }

      function stop() {
          document.removeEventListener('mousemove', move);
          document.removeEventListener('mouseup', stop);
          isDragging = false;
      }

      document.addEventListener('mousemove', move);
      document.addEventListener('mouseup', stop);
  });

  timerDiv.addEventListener('touchstart', function(e) {
      isDragging = true;
      let startX = e.touches[0].clientX - timerDiv.offsetLeft;
      let startY = e.touches[0].clientY - timerDiv.offsetTop;

      function move(e) {
          let newX = e.touches[0].clientX - startX;
          let newY = e.touches[0].clientY - startY;

          newX = Math.max(0, Math.min(newX, window.innerWidth - timerDiv.clientWidth));
          newY = Math.max(0, Math.min(newY, window.innerHeight - timerDiv.clientHeight));

          timerDiv.style.left = newX + 'px';
          timerDiv.style.top = newY + 'px';
      }

      function stop() {
          document.removeEventListener('touchmove', move);
          document.removeEventListener('touchend', stop);
          isDragging = false;
      }

      document.addEventListener('touchmove', move);
      document.addEventListener('touchend', stop);
  });
      function checkUserKey() {
          
          
          if (!userKey) {
              
              window.location.href = '/error.html';
              return;
          }
          
          try {
              
  
          const key = localStorage.getItem('key');

          if (key && !check_key(key)) {
                  window.location.href = `/error.html?user=${userKey}`;
                  return;
              }
              

              console.log('User key is valid. Proceeding...');
              console.log(userKey);
              updateTimer();

              setInterval(updateTimer, 1000);
              
          } catch (error) {
              console.error('Error checking user key:', error);

              window.location.href = '/error.html';
          }
      }



          checkUserKey();
    }
    $(document).ready(function () {

            $("#clickableLine").click(function () {
                if ($("#members").is(":visible")) {
                    $("#members").hide();

                } else {
                    $("#members").show();
          
                }
            });
        });
    const startVcButton = document.getElementById("submit-channel-name");
    const inputUrl = document.getElementById("input");
    const navbar = document.getElementById("navbar");
    const navbarContent = document.getElementById("navbar-content");

    const navbarToggleButton = document.getElementById("navbar-toggle-button");

    navbarToggleButton.addEventListener("click", function () {
      if (navbarContent.style.display === "block") {
        navbarContent.style.display = "none";
      } else {
        navbarContent.style.display = "block";
      }
    });


  </script>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.5/jszip.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery-toast-plugin@1.3.2/dist/jquery.toast.min.js"></script>

  <script src="/ff.js"></script>


  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script>

  <script src="https://download.agora.io/sdk/release/AgoraRTC_N.js"></script>

  <script src="/assets/jquery-3.4.1.min.js"></script>

  <script src="/assets/bootstrap.bundle.min.js"></script>

  <script src="/audioMixingAndAudioEffect.js"></script>
  

</body>

</html>
